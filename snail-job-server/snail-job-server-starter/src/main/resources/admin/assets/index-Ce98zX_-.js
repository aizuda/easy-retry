import{_ as Re}from"./table-header-operation.vue_vue_type_script_setup_true_lang-CCVNa7vh.js";import{as as De,av as $e,d as $,ax as Ue,aA as ye,a as ue,a_ as de,aH as Ve,aj as me,bp as Ce,p as P,o as N,c as I,h as e,$ as t,Y as X,bq as ze,a3 as Z,br as Oe,bs as Be,bt as Ke,U as Y,V as re,s as ve,W as te,b as oe,w as l,f as a,g as j,S as Ae,bu as Te,O as ke,n as pe,r as ce,t as S,Q as ge,bv as he,R as be,B as M,I as je,a4 as F,bw as Se,bx as Je,by as Pe,bo as Fe,bz as Ne,bA as xe,N as le,u as Me,a8 as Ge,a9 as Q,aa as Le}from"./index-C0jHFrT7.js";import{b as Ee,c as qe,d as He,e as We,g as Qe,h as Ye}from"./job-BxRJab5O.js";import{b as Xe,c as Ze,_ as ea,u as aa,a as ta,N as fe}from"./table-CCLDLnqu.js";import{_ as la}from"./status-switch.vue_vue_type_script_setup_true_lang-D0p-CjtO.js";import{u as oa}from"./auth-BpI7SjCm.js";import{_ as we}from"./select-group.vue_vue_type_script_setup_true_lang-BxHXAe1B.js";import{u as ra,a as na,_ as sa,b as ua}from"./form-W0W3zplR.js";import{_ as Ie}from"./operate-drawer-BhL4p7os.js";import{_ as pa,a as ia}from"./cron-input.vue_vue_type_style_index_0_lang-CaL9zcTP.js";import{_ as _e}from"./code-mirror.vue_vue_type_script_setup_true_lang-Bs8LkqQs.js";import{_ as da}from"./Space-DUmk9ljR.js";import{_ as ma,f as ca,e as ga,a as ba,b as fa}from"./Grid-CiG62sXN.js";import{_ as _a}from"./search-form.vue_vue_type_script_setup_true_lang-7J0hSeh6.js";import{_ as ya,a as va}from"./DescriptionsItem-7KqcbMhz.js";import"./group-JmFGeIOM.js";import"./close-fullscreen-rounded-Df-k0Dlo.js";import"./round-search-BfyTeFqd.js";const Ta=De("input-group-label",`
 position: relative;
 user-select: none;
 -webkit-user-select: none;
 box-sizing: border-box;
 padding: 0 12px;
 display: inline-block;
 border-radius: var(--n-border-radius);
 background-color: var(--n-group-label-color);
 color: var(--n-group-label-text-color);
 font-size: var(--n-font-size);
 line-height: var(--n-height);
 height: var(--n-height);
 flex-shrink: 0;
 white-space: nowrap;
 transition: 
 color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier);
`,[$e("border",`
 position: absolute;
 left: 0;
 right: 0;
 top: 0;
 bottom: 0;
 border-radius: inherit;
 border: var(--n-group-label-border);
 transition: border-color .3s var(--n-bezier);
 `)]),ka=Object.assign(Object.assign({},ye.props),{size:{type:String,default:"medium"},bordered:{type:Boolean,default:void 0}}),ha=$({name:"InputGroupLabel",props:ka,setup(v){const{mergedBorderedRef:y,mergedClsPrefixRef:r,inlineThemeDisabled:b}=Ue(v),s=ye("Input","-input-group-label",Ta,Ce,v,r),d=ue(()=>{const{size:_}=v,{common:{cubicBezierEaseInOut:o},self:{groupLabelColor:u,borderRadius:R,groupLabelTextColor:n,lineHeight:x,groupLabelBorder:B,[de("fontSize",_)]:G,[de("height",_)]:C}}=s.value;return{"--n-bezier":o,"--n-group-label-color":u,"--n-group-label-border":B,"--n-border-radius":R,"--n-group-label-text-color":n,"--n-font-size":G,"--n-line-height":x,"--n-height":C}}),c=b?Ve("input-group-label",ue(()=>v.size[0]),d,v):void 0;return{mergedClsPrefix:r,mergedBordered:y,cssVars:b?void 0:d,themeClass:c==null?void 0:c.themeClass,onRender:c==null?void 0:c.onRender}},render(){var v,y,r;const{mergedClsPrefix:b}=this;return(v=this.onRender)===null||v===void 0||v.call(this),me("div",{class:[`${b}-input-group-label`,this.themeClass],style:this.cssVars},(r=(y=this.$slots).default)===null||r===void 0?void 0:r.call(y),this.mergedBordered?me("div",{class:`${b}-input-group-label__border`}):null)}}),ja=$({name:"TriggerType",__name:"trigger-type",emits:["update:value"],setup(v,{emit:y}){const r=y,b=P(),s=d=>{r("update:value",d)};return(d,c)=>{const _=Z;return N(),I(_,{value:b.value,"onUpdate:value":[c[0]||(c[0]=o=>b.value=o),s],placeholder:e(t)("common.triggerType.form"),options:e(X)(e(ze)),clearable:""},null,8,["value","placeholder","options"])}}}),Sa=$({name:"BlockStrategy",__name:"block-strategy",emits:["update:value"],setup(v,{emit:y}){const r=P(),b=y,s=d=>{b("update:value",d)};return(d,c)=>{const _=Z;return N(),I(_,{value:r.value,"onUpdate:value":[c[0]||(c[0]=o=>r.value=o),s],placeholder:e(t)("common.blockStrategy.form"),options:e(X)(e(Oe)),clearable:""},null,8,["value","placeholder","options"])}}}),Na=$({name:"TriggerStrategy",__name:"executor-type",emits:["update:value"],setup(v,{emit:y}){const r=P(),b=y,s=d=>{b("update:value",d)};return(d,c)=>{const _=Z;return N(),I(_,{value:r.value,"onUpdate:value":[c[0]||(c[0]=o=>r.value=o),s],placeholder:e(t)("common.executorType.form"),options:e(X)(e(Be)),clearable:""},null,8,["value","placeholder","options"])}}}),xa=$({name:"TaskType",__name:"task-type",emits:["update:value"],setup(v,{emit:y}){const r=y,b=P(),s=d=>{r("update:value",d)};return(d,c)=>{const _=Z;return N(),I(_,{value:b.value,"onUpdate:value":[c[0]||(c[0]=o=>b.value=o),s],placeholder:e(t)("common.routeKey.routeForm"),options:e(X)(e(Ke)),clearable:""},null,8,["value","placeholder","options"])}}}),wa=$({name:"JobTriggerInterval",__name:"job-trigger-interval",props:Y({triggerType:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(v){const y=re(v,"modelValue"),r=v,b=ve(),s=P(r.triggerType===2?Number(y.value):60),d=P(r.triggerType===3?y.value:"* * * * * ?");return te(s,c=>{r.triggerType===2&&(y.value=`${c}`)},{immediate:!0}),te(d,c=>{r.triggerType===3&&(y.value=c)},{immediate:!0}),te(()=>r.triggerType,c=>{c===2?y.value=`${s.value}`:c===3?y.value=d.value:y.value="*"},{immediate:!0}),(c,_)=>{const o=Te,u=ha,R=ke,n=pe;return N(),oe("div",null,[c.triggerType===2?(N(),I(R,{key:0},{default:l(()=>[a(o,{value:s.value,"onUpdate:value":_[0]||(_[0]=x=>s.value=x),placeholder:c.$t("page.jobTask.form.triggerInterval")},null,8,["value","placeholder"]),a(u,null,{default:l(()=>[j("秒")]),_:1})]),_:1})):c.triggerType===3?(N(),I(e(pa),{key:1,modelValue:d.value,"onUpdate:modelValue":_[1]||(_[1]=x=>d.value=x),placeholder:c.$t("page.jobTask.form.triggerInterval_CRON"),lang:e(b).locale},null,8,["modelValue","placeholder","lang"])):c.triggerType===99?(N(),I(n,{key:2,disabled:""})):Ae("",!0)])}}}),Ia=$({name:"JobTaskOperateDrawer",__name:"job-task-operate-drawer",props:Y({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:Y(["submitted"],["update:visible"]),setup(v,{emit:y}){const r=v,b=y,s=re(v,"visible"),d=ce({args:[{arg:""}]}),{formRef:c,validate:_,restoreValidation:o}=ra(),{defaultRequiredRule:u}=na(),R=ue(()=>({add:t("page.jobTask.addJobTask"),edit:t("page.jobTask.editJobTask")})[r.operateType]),n=ce(x());function x(){return{groupName:"",jobName:"",argsStr:"",argsType:1,jobStatus:1,routeKey:1,executorType:1,triggerType:2,executorInfo:"",triggerInterval:"60",blockStrategy:1,executorTimeout:60,maxRetryTimes:3,retryInterval:1,taskType:1,parallelNum:1,description:""}}const B={groupName:u,jobName:u,argsType:u,jobStatus:u,routeKey:u,executorType:u,executorInfo:u,triggerType:u,triggerInterval:u,blockStrategy:u,executorTimeout:u,maxRetryTimes:u,retryInterval:u,taskType:u,parallelNum:u};function G(){if(r.operateType==="add"){Object.assign(n,x());return}r.operateType==="edit"&&r.rowData&&(Object.assign(n,r.rowData),n.taskType===3&&n.argsStr&&Object.assign(d,{args:JSON.parse(n.argsStr).map(w=>({arg:w}))}))}function C(){s.value=!1}async function ee(){var w,m;if(await _(),r.operateType==="add"){const{groupName:U,jobName:T,argsType:K,jobStatus:A,routeKey:i,executorType:g,executorInfo:f,triggerType:k,triggerInterval:V,blockStrategy:h,executorTimeout:D,maxRetryTimes:L,retryInterval:z,taskType:E,parallelNum:O,description:q}=n,{error:H}=await Ee({groupName:U,jobName:T,argsStr:ae(),argsType:K,jobStatus:A,routeKey:i,executorType:g,executorInfo:f,triggerType:k,triggerInterval:V,blockStrategy:h,executorTimeout:D,maxRetryTimes:L,retryInterval:z,taskType:E,parallelNum:O,description:q});if(H)return;(w=window.$message)==null||w.success(t("common.addSuccess"))}if(r.operateType==="edit"){const{id:U,groupName:T,jobName:K,argsType:A,jobStatus:i,routeKey:g,executorType:f,executorInfo:k,triggerType:V,triggerInterval:h,blockStrategy:D,executorTimeout:L,maxRetryTimes:z,retryInterval:E,taskType:O,parallelNum:q,description:H}=n,{error:p}=await qe({id:U,groupName:T,jobName:K,argsStr:ae(),argsType:A,jobStatus:i,routeKey:g,executorType:f,executorInfo:k,triggerType:V,triggerInterval:h,blockStrategy:D,executorTimeout:L,maxRetryTimes:z,retryInterval:E,taskType:O,parallelNum:q,description:H});if(p)return;(m=window.$message)==null||m.success(t("common.updateSuccess"))}C(),b("submitted")}function ae(){return n.taskType===3&&d.args?JSON.stringify(d.args.map(w=>w.arg)):n.argsStr}const ne=w=>{d.args.splice(w,1)},se=()=>{d.args.push({arg:""})};return te(s,()=>{s.value&&(G(),o())}),(w,m)=>{const U=pe,T=sa,K=we,A=ba,i=da,g=ma,f=Ze,k=M,V=Xe,h=je,D=ca,L=Sa,z=ga,E=ja,O=Te,q=ke,H=ua;return N(),I(Ie,{modelValue:s.value,"onUpdate:modelValue":m[16]||(m[16]=p=>s.value=p),title:R.value,"min-size":480,onHandleSubmit:ee},{footer:l(()=>[a(i,{size:16},{default:l(()=>[a(k,{onClick:C},{default:l(()=>[j(S(e(t)("common.cancel")),1)]),_:1}),a(k,{type:"primary",onClick:ee},{default:l(()=>[j(S(e(t)("common.save")),1)]),_:1})]),_:1})]),default:l(()=>[a(H,{ref_key:"formRef",ref:c,model:n,rules:B},{default:l(()=>[a(T,{label:e(t)("page.jobTask.jobName"),path:"jobName"},{default:l(()=>[a(U,{value:n.jobName,"onUpdate:value":m[0]||(m[0]=p=>n.jobName=p),maxlength:64,"show-count":"",placeholder:e(t)("page.jobTask.form.jobName")},null,8,["value","placeholder"])]),_:1},8,["label"]),a(T,{label:e(t)("page.jobTask.groupName"),path:"groupName"},{default:l(()=>[a(K,{value:n.groupName,"onUpdate:value":m[1]||(m[1]=p=>n.groupName=p)},null,8,["value"])]),_:1},8,["label"]),a(T,{label:e(t)("page.jobTask.jobStatus"),path:"jobStatus"},{default:l(()=>[a(g,{value:n.jobStatus,"onUpdate:value":m[2]||(m[2]=p=>n.jobStatus=p),name:"jobStatus"},{default:l(()=>[a(i,null,{default:l(()=>[(N(!0),oe(be,null,ge(e(he),p=>(N(),I(A,{key:p.value,value:p.value,label:e(t)(p.label)},null,8,["value","label"]))),128))]),_:1})]),_:1},8,["value"])]),_:1},8,["label"]),a(T,{label:e(t)("page.jobTask.executorType"),path:"executorType"},{default:l(()=>[a(Na,{value:n.executorType,"onUpdate:value":m[3]||(m[3]=p=>n.executorType=p)},null,8,["value"])]),_:1},8,["label"]),a(T,{label:e(t)("page.jobTask.executorInfo"),path:"executorInfo"},{default:l(()=>[a(U,{value:n.executorInfo,"onUpdate:value":m[4]||(m[4]=p=>n.executorInfo=p),placeholder:e(t)("page.jobTask.form.executorInfo")},null,8,["value","placeholder"])]),_:1},8,["label"]),a(T,{label:e(t)("page.jobTask.taskType"),path:"taskType"},{default:l(()=>[a(xa,{value:n.taskType,"onUpdate:value":m[5]||(m[5]=p=>n.taskType=p),placeholder:e(t)("page.jobTask.form.taskType")},null,8,["value","placeholder"])]),_:1},8,["label"]),a(T,{label:e(t)("page.jobTask.argsStr"),path:"argsStr",rule:n.taskType===3?e(u):void 0},{default:l(()=>[n.taskType===3?(N(),I(h,{key:0,class:"flex-col"},{default:l(()=>[(N(!0),oe(be,null,ge(d.args,(p,W)=>(N(),I(T,{key:W,label:`分片参数 ${W+1}`,path:`args[${W}].arg`,"show-feedback":!1,class:"m-b-12px",rule:{required:!0,message:`${e(t)("page.jobTask.form.argsStr")} ${W+1}`,trigger:["input","blur"],validator(){return!!p.arg}}},{default:l(()=>[a(_e,{modelValue:p.arg,"onUpdate:modelValue":ie=>p.arg=ie,lang:"json",placeholder:e(t)("page.jobTask.form.argsStr")},null,8,["modelValue","onUpdate:modelValue","placeholder"]),a(k,{class:"ml-12px",type:"error",dashed:"",onClick:ie=>ne(W)},{default:l(()=>[a(f,{class:"text-icon"})]),_:2},1032,["onClick"])]),_:2},1032,["label","path","rule"]))),128)),a(k,{block:"",dashed:"","attr-type":"button",onClick:se},{default:l(()=>[a(V,{class:"text-icon"})]),_:1})]),_:1})):(N(),I(_e,{key:1,modelValue:n.argsStr,"onUpdate:modelValue":m[6]||(m[6]=p=>n.argsStr=p),lang:"json",placeholder:e(t)("page.jobTask.form.argsStr")},null,8,["modelValue","placeholder"]))]),_:1},8,["label","rule"]),a(z,{cols:"2 s:1 m:2",responsive:"screen","x-gap":"20"},{default:l(()=>[a(D,null,{default:l(()=>[a(T,{label:e(t)("page.jobTask.routeKey"),path:"routeKey"},{default:l(()=>[a(ia,{value:n.routeKey,"onUpdate:value":m[7]||(m[7]=p=>n.routeKey=p),"task-type":n.taskType},null,8,["value","task-type"])]),_:1},8,["label"])]),_:1}),a(D,null,{default:l(()=>[a(T,{label:e(t)("page.jobTask.blockStrategy"),path:"blockStrategy"},{default:l(()=>[a(L,{value:n.blockStrategy,"onUpdate:value":m[8]||(m[8]=p=>n.blockStrategy=p)},null,8,["value"])]),_:1},8,["label"])]),_:1})]),_:1}),a(z,{cols:"2 s:1 m:2",responsive:"screen","x-gap":"20"},{default:l(()=>[a(D,null,{default:l(()=>[a(T,{label:e(t)("page.jobTask.triggerType"),path:"triggerType"},{default:l(()=>[a(E,{value:n.triggerType,"onUpdate:value":m[9]||(m[9]=p=>n.triggerType=p),placeholder:e(t)("page.jobTask.form.triggerType")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),a(D,null,{default:l(()=>[a(T,{label:e(t)("page.jobTask.triggerInterval"),path:"triggerInterval"},{default:l(()=>[a(wa,{modelValue:n.triggerInterval,"onUpdate:modelValue":m[10]||(m[10]=p=>n.triggerInterval=p),"trigger-type":n.triggerType},null,8,["modelValue","trigger-type"])]),_:1},8,["label"])]),_:1})]),_:1}),a(z,{cols:"2 s:1 m:2",responsive:"screen","x-gap":"20"},{default:l(()=>[a(D,null,{default:l(()=>[a(T,{label:e(t)("page.jobTask.executorTimeout"),path:"executorTimeout"},{default:l(()=>[a(q,null,{default:l(()=>[a(O,{value:n.executorTimeout,"onUpdate:value":m[11]||(m[11]=p=>n.executorTimeout=p),min:1,max:99999999,placeholder:e(t)("page.jobTask.form.executorTimeout"),clearable:""},null,8,["value","placeholder"])]),_:1})]),_:1},8,["label"])]),_:1}),a(D,null,{default:l(()=>[a(T,{label:e(t)("page.jobTask.maxRetryTimes"),path:"maxRetryTimes"},{default:l(()=>[a(O,{value:n.maxRetryTimes,"onUpdate:value":m[12]||(m[12]=p=>n.maxRetryTimes=p),min:1,max:999,placeholder:e(t)("page.jobTask.form.maxRetryTimes"),clearable:""},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1}),a(z,{cols:"2 s:1 m:2",responsive:"screen","x-gap":"20"},{default:l(()=>[a(D,null,{default:l(()=>[a(T,{label:e(t)("page.jobTask.retryInterval"),path:"retryInterval"},{default:l(()=>[a(O,{value:n.retryInterval,"onUpdate:value":m[13]||(m[13]=p=>n.retryInterval=p),min:1,max:99999999,placeholder:e(t)("page.jobTask.form.retryInterval"),clearable:""},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1}),a(D,null,{default:l(()=>[a(T,{label:e(t)("page.jobTask.parallelNum"),path:"parallelNum"},{default:l(()=>[a(O,{value:n.parallelNum,"onUpdate:value":m[14]||(m[14]=p=>n.parallelNum=p),min:1,max:999,placeholder:e(t)("page.jobTask.form.parallelNum"),clearable:""},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1})]),_:1}),a(T,{label:e(t)("page.jobTask.description"),path:"description"},{default:l(()=>[a(U,{value:n.description,"onUpdate:value":m[15]||(m[15]=p=>n.description=p),type:"textarea",placeholder:e(t)("page.jobTask.form.description")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),Ra=$({name:"JobTaskSearch",__name:"job-task-search",props:{model:{required:!0},modelModifiers:{}},emits:Y(["reset","search"],["update:model"]),setup(v,{emit:y}){const r=y,b=re(v,"model");function s(){r("reset")}function d(){r("search")}return(c,_)=>{const o=ea,u=pe,R=Z,n=_a;return N(),I(n,{model:b.value,onSearch:d,onReset:s},{default:l(()=>[a(o,{span:"24 s:12 m:6",label:e(t)("page.jobTask.groupName"),path:"groupName",class:"pr-24px"},{default:l(()=>[a(we,{value:b.value.groupName,"onUpdate:value":_[0]||(_[0]=x=>b.value.groupName=x)},null,8,["value"])]),_:1},8,["label"]),a(o,{span:"24 s:12 m:6",label:e(t)("page.jobTask.jobName"),path:"jobName",class:"pr-24px"},{default:l(()=>[a(u,{value:b.value.jobName,"onUpdate:value":_[1]||(_[1]=x=>b.value.jobName=x),placeholder:e(t)("page.jobTask.form.jobName")},null,8,["value","placeholder"])]),_:1},8,["label"]),a(o,{span:"24 s:12 m:6",label:e(t)("page.jobTask.jobStatus"),path:"jobStatus",class:"pr-24px"},{default:l(()=>[a(R,{value:b.value.jobStatus,"onUpdate:value":_[2]||(_[2]=x=>b.value.jobStatus=x),placeholder:e(t)("page.jobTask.form.jobStatus"),options:e(X)(e(he))},null,8,["value","placeholder","options"])]),_:1},8,["label"])]),_:1},8,["model"])}}}),Da=$({name:"JobTaskDetailDrawer",__name:"job-task-detail-drawer",props:Y({rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:["update:visible"],setup(v){const y=re(v,"visible");return(r,b)=>{const s=ya,d=le,c=va,_=Ie;return N(),I(_,{modelValue:y.value,"onUpdate:modelValue":b[0]||(b[0]=o=>y.value=o),title:e(t)("page.jobTask.detail")},{default:l(()=>[a(c,{"label-placement":"top",bordered:"",column:2},{default:l(()=>[a(s,{label:e(t)("page.jobTask.groupName")},{default:l(()=>{var o;return[j(S((o=r.rowData)==null?void 0:o.groupName),1)]}),_:1},8,["label"]),a(s,{label:e(t)("page.jobTask.jobName")},{default:l(()=>{var o;return[j(S((o=r.rowData)==null?void 0:o.jobName),1)]}),_:1},8,["label"]),a(s,{label:e(t)("page.jobTask.taskType")},{default:l(()=>{var o;return[a(d,{type:e(F)((o=r.rowData)==null?void 0:o.taskType)},{default:l(()=>{var u;return[j(S(e(t)(e(Se)[(u=r.rowData)==null?void 0:u.taskType])),1)]}),_:1},8,["type"])]}),_:1},8,["label"]),a(s,{label:e(t)("page.jobTask.argsStr")},{default:l(()=>{var o;return[j(S((o=r.rowData)==null?void 0:o.argsStr),1)]}),_:1},8,["label"]),a(s,{label:e(t)("page.jobTask.nextTriggerAt")},{default:l(()=>{var o;return[j(S((o=r.rowData)==null?void 0:o.nextTriggerAt),1)]}),_:1},8,["label"]),a(s,{label:e(t)("page.jobTask.jobStatus")},{default:l(()=>{var o;return[a(d,{type:e(F)((o=r.rowData)==null?void 0:o.jobStatus)},{default:l(()=>{var u;return[j(S(e(t)(e(Je)[(u=r.rowData)==null?void 0:u.jobStatus])),1)]}),_:1},8,["type"])]}),_:1},8,["label"]),a(s,{label:e(t)("page.jobTask.routeKey")},{default:l(()=>{var o;return[a(d,{type:e(F)((o=r.rowData)==null?void 0:o.routeKey)},{default:l(()=>{var u;return[j(S(e(t)(e(Pe)[(u=r.rowData)==null?void 0:u.routeKey])),1)]}),_:1},8,["type"])]}),_:1},8,["label"]),a(s,{label:e(t)("page.jobTask.executorType")},{default:l(()=>{var o;return[a(d,{type:e(F)((o=r.rowData)==null?void 0:o.executorType)},{default:l(()=>{var u;return[j(S(e(t)(e(Fe)[(u=r.rowData)==null?void 0:u.executorType])),1)]}),_:1},8,["type"])]}),_:1},8,["label"]),a(s,{label:e(t)("page.jobTask.executorInfo")},{default:l(()=>{var o;return[j(S((o=r.rowData)==null?void 0:o.executorInfo),1)]}),_:1},8,["label"]),a(s,{label:e(t)("page.jobTask.triggerType")},{default:l(()=>{var o;return[a(d,{type:e(F)((o=r.rowData)==null?void 0:o.triggerType)},{default:l(()=>{var u;return[j(S(e(t)(e(Ne)[(u=r.rowData)==null?void 0:u.triggerType])),1)]}),_:1},8,["type"])]}),_:1},8,["label"]),a(s,{label:e(t)("page.jobTask.triggerInterval")},{default:l(()=>{var o;return[j(S((o=r.rowData)==null?void 0:o.triggerInterval),1)]}),_:1},8,["label"]),a(s,{label:e(t)("page.jobTask.blockStrategy")},{default:l(()=>{var o;return[a(d,{type:e(F)((o=r.rowData)==null?void 0:o.blockStrategy)},{default:l(()=>{var u;return[j(S(e(t)(e(xe)[(u=r.rowData)==null?void 0:u.blockStrategy])),1)]}),_:1},8,["type"])]}),_:1},8,["label"]),a(s,{label:e(t)("page.jobTask.executorTimeout")},{default:l(()=>{var o;return[j(S((o=r.rowData)==null?void 0:o.executorTimeout),1)]}),_:1},8,["label"]),a(s,{label:e(t)("page.jobTask.maxRetryTimes")},{default:l(()=>{var o;return[j(S((o=r.rowData)==null?void 0:o.maxRetryTimes),1)]}),_:1},8,["label"]),a(s,{label:e(t)("page.jobTask.retryInterval")},{default:l(()=>{var o;return[j(S((o=r.rowData)==null?void 0:o.retryInterval),1)]}),_:1},8,["label"]),a(s,{label:e(t)("page.jobTask.parallelNum")},{default:l(()=>{var o;return[j(S((o=r.rowData)==null?void 0:o.parallelNum),1)]}),_:1},8,["label"]),a(s,{label:e(t)("page.jobTask.description"),span:2},{default:l(()=>{var o;return[j(S((o=r.rowData)==null?void 0:o.description),1)]}),_:1},8,["label"])]),_:1})]),_:1},8,["modelValue","title"])}}}),$a={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function J(v){return typeof v=="function"||Object.prototype.toString.call(v)==="[object Object]"&&!Le(v)}const Qa=$({name:"job_task",__name:"index",setup(v){const{hasAuth:y}=oa(),r=ve(),{routerPushByKey:b}=Me(),s=P(),{bool:d,setTrue:c}=Ge(!1),{columnChecks:_,columns:o,data:u,getData:R,loading:n,mobilePagination:x,searchParams:B,resetSearchParams:G}=aa({apiFn:He,apiParams:{page:1,size:10,groupName:null,jobName:null,jobStatus:null},columns:()=>[{key:"index",title:t("common.index"),align:"center",width:120},{key:"jobName",title:t("page.jobTask.jobName"),align:"center",width:140,fixed:"left",render:i=>{async function g(){s.value=i,c()}return a(M,{text:!0,tag:"a",type:"primary",onClick:g,class:"ws-normal"},{default:()=>[i.jobName]})}},{key:"groupName",title:t("page.jobTask.groupName"),align:"left",width:180},{key:"nextTriggerAt",title:t("page.jobTask.nextTriggerAt"),align:"center",width:120},{key:"jobStatus",title:t("page.jobTask.jobStatus"),align:"center",width:60,render:i=>{const g=async(f,k)=>{var h;const{error:V}=await Ye({id:i.id,jobStatus:f});V||(i.jobStatus=f,(h=window.$message)==null||h.success(t("common.updateSuccess"))),k()};return a(la,{value:i.jobStatus,"onUpdate:value":f=>i.jobStatus=f,onFetch:g},null)}},{key:"taskType",title:t("page.jobTask.taskType"),align:"center",width:120,render:i=>{if(i.taskType===null)return null;const g={1:"info",2:"success",3:"error"},f=t(Se[i.taskType]);return a(le,{type:g[i.taskType]},J(f)?f:{default:()=>[f]})}},{key:"triggerType",title:t("page.jobTask.triggerType"),align:"center",width:120,render:i=>{if(i.triggerType===null)return null;const g={2:"info",3:"success",99:"error"},f=t(Ne[i.triggerType]);return a(le,{type:g[i.triggerType]},J(f)?f:{default:()=>[f]})}},{key:"triggerInterval",title:t("page.jobTask.triggerInterval"),align:"center",width:80},{key:"blockStrategy",title:t("page.jobTask.blockStrategy"),align:"center",width:80,render:i=>{if(i.blockStrategy===null)return null;const g={1:"info",2:"success",3:"error"},f=t(xe[i.blockStrategy]);return a(le,{type:g[i.blockStrategy]},J(f)?f:{default:()=>[f]})}},{key:"executorTimeout",title:t("page.jobTask.executorTimeout"),align:"center",width:80},{key:"updateDt",title:t("page.jobTask.updateDt"),align:"center",width:120},{key:"operate",title:t("common.operate"),align:"center",width:180,fixed:"right",render:i=>{let g,f;return a("div",{class:"flex-center gap-8px"},[a(fe,{onPositiveClick:()=>K(i.id)},{default:()=>t("common.confirmExecute"),trigger:()=>{let k;return a(M,{type:"error",ghost:!0,size:"small"},J(k=t("common.execute"))?k:{default:()=>[k]})}}),a(M,{type:"primary",ghost:!0,size:"small",onClick:()=>A(i.id)},J(g=t("common.batchList"))?g:{default:()=>[g]}),a(M,{type:"warning",ghost:!0,size:"small",onClick:()=>T(i.id)},J(f=t("common.edit"))?f:{default:()=>[f]}),y("R_ADMIN")?a(fe,{onPositiveClick:()=>U(i.id)},{default:()=>t("common.confirmDelete"),trigger:()=>{let k;return a(M,{type:"error",ghost:!0,size:"small"},J(k=t("common.delete"))?k:{default:()=>[k]})}}):""])}}]}),{drawerVisible:C,operateType:ee,editingData:ae,handleAdd:ne,handleEdit:se,checkedRowKeys:w,onDeleted:m}=ta(u,R);async function U(i){const{error:g}=await We(i);g||m()}function T(i){se(i)}async function K(i){var f,k;const{error:g}=await Qe(i);g?(f=window.$message)==null||f.error(t("common.executeFailed")):(k=window.$message)==null||k.success(t("common.executeSuccess"))}function A(i){b("job_batch",{query:{jobId:i}})}return(i,g)=>{const f=Re,k=fa,V=je;return N(),oe("div",$a,[a(Ra,{model:e(B),"onUpdate:model":g[0]||(g[0]=h=>Q(B)?B.value=h:null),onReset:e(G),onSearch:e(R)},null,8,["model","onReset","onSearch"]),a(V,{title:e(t)("page.jobTask.title"),bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper","header-class":"view-card-header"},{"header-extra":l(()=>[a(f,{columns:e(_),"onUpdate:columns":g[1]||(g[1]=h=>Q(_)?_.value=h:null),loading:e(n),"show-delete":!1,onAdd:e(ne),onRefresh:e(R)},null,8,["columns","loading","onAdd","onRefresh"])]),default:l(()=>[a(k,{"checked-row-keys":e(w),"onUpdate:checkedRowKeys":g[2]||(g[2]=h=>Q(w)?w.value=h:null),columns:e(o),data:e(u),"flex-height":!e(r).isMobile,"scroll-x":2e3,loading:e(n),remote:"","row-key":h=>h.id,pagination:e(x),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"])]),_:1},8,["title"]),a(Ia,{visible:e(C),"onUpdate:visible":g[3]||(g[3]=h=>Q(C)?C.value=h:null),"operate-type":e(ee),"row-data":e(ae),onSubmitted:e(R)},null,8,["visible","operate-type","row-data","onSubmitted"]),a(Da,{visible:e(d),"onUpdate:visible":g[4]||(g[4]=h=>Q(d)?d.value=h:null),"row-data":s.value},null,8,["visible","row-data"])])}}});export{Qa as default};
