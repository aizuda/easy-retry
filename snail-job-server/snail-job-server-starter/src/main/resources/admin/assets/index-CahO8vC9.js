import{_ as O}from"./table-header-operation.vue_vue_type_script_setup_true_lang-CCVNa7vh.js";import{d as W,U as T,p as q,V as z,o as D,c as j,w as p,f as l,h as o,$ as t,a3 as A,bb as F,J as G,s as L,b as V,a9 as S,bm as J,N as x,bn as K,B as R,aO as E,dJ as H,I as Q,aa as X}from"./index-C0jHFrT7.js";import{f as Y,a as Z,b as ee}from"./workflow-Ds6L9qGA.js";import{_ as te,u as ae,a as oe,N as le}from"./table-CCLDLnqu.js";import{_ as se}from"./search-form.vue_vue_type_script_setup_true_lang-7J0hSeh6.js";import{_ as ne}from"./select-group.vue_vue_type_script_setup_true_lang-BxHXAe1B.js";import{_ as re}from"./task-batch-status.vue_vue_type_script_setup_true_lang-C6yZWcT9.js";import{b as ie}from"./Grid-CiG62sXN.js";import"./Space-DUmk9ljR.js";import"./form-W0W3zplR.js";import"./round-search-BfyTeFqd.js";import"./group-JmFGeIOM.js";const ce=W({name:"WorkflowBatchSearch",__name:"workflow-batch-search",props:{model:{required:!0},modelModifiers:{}},emits:T(["reset","search"],["update:model"]),setup(m,{emit:b}){const d=b,g=q([]),i=z(m,"model");function B(){d("reset")}function f(){d("search")}async function h(c){const n=await Y({groupName:c});g.value=n.data}return h(""),(c,n)=>{const w=te,k=A,v=se;return D(),j(v,{model:i.value,onSearch:f,onReset:B},{default:p(()=>[l(w,{span:"24 s:12 m:6",label:o(t)("page.workflowBatch.groupName"),path:"groupName",class:"pr-24px"},{default:p(()=>[l(ne,{value:i.value.groupName,"onUpdate:value":[n[0]||(n[0]=r=>i.value.groupName=r),h]},null,8,["value"])]),_:1},8,["label"]),l(w,{span:"24 s:12 m:6",label:o(t)("page.workflowBatch.workflowName"),"label-width":100,path:"workflowName",class:"pr-24px"},{default:p(()=>[l(k,{value:i.value.workflowId,"onUpdate:value":n[1]||(n[1]=r=>i.value.workflowId=r),placeholder:o(t)("page.workflowBatch.form.workflowName"),"value-field":"id","label-field":"workflowName",options:g.value,clearable:"",filterable:""},null,8,["value","placeholder","options"])]),_:1},8,["label"]),l(w,{span:"24 s:12 m:6",label:o(t)("page.workflowBatch.taskBatchStatus"),path:"taskBatchStatus",class:"pr-24px"},{default:p(()=>[l(re,{value:i.value.taskBatchStatus,"onUpdate:value":n[2]||(n[2]=r=>i.value.taskBatchStatus=r)},null,8,["value"])]),_:1},8,["label"])]),_:1},8,["model"])}}}),ue={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function _(m){return typeof m=="function"||Object.prototype.toString.call(m)==="[object Object]"&&!X(m)}const Se=W({name:"workflow_batch",__name:"index",setup(m){var y,N;const b=F(),d=G(),g=((y=d.query)==null?void 0:y.workflowId)===void 0?null:Number.parseInt((N=d.query)==null?void 0:N.workflowId,10),i=L(),{columns:B,columnChecks:f,data:h,getData:c,loading:n,mobilePagination:w,searchParams:k,resetSearchParams:v}=ae({apiFn:Z,apiParams:{page:1,size:10,workflowId:g,groupName:null,taskBatchStatus:null},columns:()=>[{key:"id",title:t("common.index"),align:"center",width:120},{key:"workflowName",title:t("page.workflowBatch.workflowName"),align:"left",minWidth:120},{key:"groupName",title:t("page.workflowBatch.groupName"),align:"left",minWidth:120},{key:"executionAt",title:t("page.workflowBatch.executionAt"),align:"left",minWidth:120},{key:"taskBatchStatus",title:t("page.workflowBatch.taskBatchStatus"),align:"left",minWidth:120,render:e=>{if(!e.taskBatchStatus)return null;const a={1:"info",2:"success",3:"success",4:"error",5:"warning",6:"warning"},s=t(J[e.taskBatchStatus]);return l(x,{type:a[e.taskBatchStatus]},_(s)?s:{default:()=>[s]})}},{key:"operationReason",title:t("page.workflowBatch.operationReason"),align:"left",minWidth:120,render:e=>{if(!e.operationReason)return null;const a=t(K[e.operationReason]);return l(x,{type:"warning"},_(a)?a:{default:()=>[a]})}},{key:"createDt",title:t("page.workflowBatch.createDt"),align:"left",minWidth:120},{key:"operate",title:t("common.operate"),align:"center",width:130,render:e=>{let a;return l("div",{class:"flex-center gap-8px"},[l(R,{type:"primary",ghost:!0,size:"small",onClick:()=>C(e.id)},_(a=t("common.detail"))?a:{default:()=>[a]}),(e==null?void 0:e.taskBatchStatus)===1||(e==null?void 0:e.taskBatchStatus)===2?E(l(le,{onPositiveClick:()=>U(e.id)},{default:()=>t("common.confirmStop"),trigger:()=>{let s;return l(R,{type:"error",ghost:!0,size:"small"},_(s=t("common.stop"))?s:{default:()=>[s]})}}),[[H("if"),""]]):""])}}]}),{checkedRowKeys:r,onBatchDeleted:$}=oe(h,c);async function I(){console.log(r.value),$()}async function U(e){var s;const{error:a}=await ee(e);a||((s=window.$message)==null||s.success(t("common.executeSuccess")),c())}function C(e){b.push({path:"/workflow/form/batch",query:{id:e}})}return(e,a)=>{const s=O,P=ie,M=Q;return D(),V("div",ue,[l(ce,{model:o(k),"onUpdate:model":a[0]||(a[0]=u=>S(k)?k.value=u:null),onReset:o(v),onSearch:o(c)},null,8,["model","onReset","onSearch"]),l(M,{title:o(t)("page.workflowBatch.title"),bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper","header-class":"view-card-header"},{"header-extra":p(()=>[l(s,{columns:o(f),"onUpdate:columns":a[1]||(a[1]=u=>S(f)?f.value=u:null),"disabled-delete":o(r).length===0,loading:o(n),"show-add":!1,"show-delete":!1,onDelete:I,onRefresh:o(c)},null,8,["columns","disabled-delete","loading","onRefresh"])]),default:p(()=>[l(P,{"checked-row-keys":o(r),"onUpdate:checkedRowKeys":a[2]||(a[2]=u=>S(r)?r.value=u:null),columns:o(B),data:o(h),"flex-height":!o(i).isMobile,"scroll-x":962,loading:o(n),remote:"","row-key":u=>u.id,pagination:o(w),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"])]),_:1},8,["title"])])}}});export{Se as default};
