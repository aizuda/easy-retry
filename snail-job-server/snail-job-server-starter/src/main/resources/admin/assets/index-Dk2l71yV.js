import{bj as L,d as Z,U as j,V as Y,o as C,c as A,w as l,aX as Te,f as t,be as Se,g as h,t as v,B as M,S as Q,b as me,e as ce,a as we,$ as a,r as fe,p as q,W as ge,i as ae,h as e,a1 as X,Y as oe,dz as le,a3 as ne,n as re,a2 as De,O as Ie,bl as ze,a4 as ee,cx as ye,cw as _e,N as te,bi as xe,cc as Re,bh as Ue,a8 as de,s as $e,a9 as H,I as Ce,aa as Ve}from"./index-C0jHFrT7.js";import{d as Ae,e as Be,b as Me,c as qe,N as E,_ as Le,u as Pe,a as Ge}from"./table-CCLDLnqu.js";import{_ as se}from"./Space-DUmk9ljR.js";import{u as be,a as he,_ as ve,b as Ne}from"./form-W0W3zplR.js";import{_ as ue}from"./operate-drawer-BhL4p7os.js";import{e as ie}from"./group-JmFGeIOM.js";import{f as ke}from"./retry-scene-CfkrljLS.js";import{_ as Oe}from"./code-mirror.vue_vue_type_script_setup_true_lang-Bs8LkqQs.js";import{_ as We}from"./search-form.vue_vue_type_script_setup_true_lang-7J0hSeh6.js";import{_ as Fe,a as je}from"./log-BbSL6yML.js";import{_ as He,a as Ee}from"./DescriptionsItem-7KqcbMhz.js";import{b as Ze}from"./Grid-CiG62sXN.js";import"./close-fullscreen-rounded-Df-k0Dlo.js";import"./round-search-BfyTeFqd.js";import"./CollapseItem-CX8YdGkG.js";function Ke(m){return L({url:"/retry-task/list",method:"get",params:m})}function Xe(m,S){return L({url:`/retry-task/${m}?groupName=${S}`,method:"get"})}function Ye(m){return L({url:"/retry-task",method:"post",data:m})}function Je(m){return L({url:"/retry-task/batch",method:"post",data:m})}function Qe(m){return L({url:"/retry-task/status",method:"put",data:m})}function et(m){return L({url:"/retry-task/manual/trigger/retry/task",method:"post",data:m})}function pe(m){return L({url:"/retry-task/batch",method:"delete",data:m})}function tt(m){return L({url:"/retry-task/generate/idempotent-id",method:"post",data:m})}const at=Z({name:"CustomerTableHeaderOperation",__name:"customer-table-header-operation",props:j({itemAlign:{},disabledDelete:{type:Boolean},loading:{type:Boolean},showDelete:{type:Boolean,default:!0},showAdd:{type:Boolean,default:!0}},{columns:{default:()=>[]},columnsModifiers:{}}),emits:j(["add","batchAdd","delete","refresh"],["update:columns"]),setup(m,{emit:S}){const f=S,p=Y(m,"columns");function N(){f("add")}function R(){f("batchAdd")}function I(){f("delete")}function w(){f("refresh")}return(s,z)=>{const i=Me,c=M,u=qe,_=E,g=Ae,T=Be,d=se;return C(),A(d,{align:s.itemAlign,wrap:"",justify:"end",class:"lt-sm:w-200px"},{default:l(()=>[Te(s.$slots,"default",{},()=>[s.showAdd?(C(),A(c,{key:0,size:"small",ghost:"",type:"primary",onClick:N},{icon:l(()=>[t(i,{class:"text-icon"})]),default:l(()=>[h(" "+v(s.$t("common.add")),1)]),_:1})):Q("",!0),s.showAdd?(C(),A(c,{key:1,size:"small",ghost:"",type:"primary",onClick:R},{icon:l(()=>[t(i,{class:"text-icon"})]),default:l(()=>[h(" "+v(s.$t("common.batchAdd")),1)]),_:1})):Q("",!0),s.showDelete?(C(),A(_,{key:2,onPositiveClick:I},{trigger:l(()=>[t(c,{size:"small",ghost:"",type:"error",disabled:s.disabledDelete},{icon:l(()=>[t(u,{class:"text-icon"})]),default:l(()=>[h(" "+v(s.$t("common.batchDelete")),1)]),_:1},8,["disabled"])]),default:l(()=>[h(" "+v(s.$t("common.confirmDelete")),1)]),_:1})):Q("",!0)]),t(c,{size:"small",onClick:w},{icon:l(()=>[t(g,{class:Se(["text-icon",{"animate-spin":s.loading}])},null,8,["class"])]),default:l(()=>[h(" "+v(s.$t("common.refresh")),1)]),_:1}),t(T,{columns:p.value,"onUpdate:columns":z[0]||(z[0]=x=>p.value=x)},null,8,["columns"])]),_:3},8,["align"])}}}),ot={class:"inline-block",viewBox:"0 0 36 36",width:"1em",height:"1em"},lt=ce("path",{fill:"currentColor",d:"M15 32H3a1 1 0 0 0 0 2h12a1 1 0 0 0 0-2M5 30h8a1 1 0 0 0 1-1V4a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v25a1 1 0 0 0 1 1M9 5.92a1.5 1.5 0 1 1-1.5 1.5A1.5 1.5 0 0 1 9 5.92M6 12.2h5.84v1.6H6Zm0 3h5.84v1.6H6Zm0 3h6v1.6H6ZM16 8h2v1.6h-2zm4 0h2v1.6h-2zm13-3.8h-8a.8.8 0 0 0-.8.8v6a.8.8 0 0 0 .8.8h8a.8.8 0 0 0 .8-.8V5a.8.8 0 0 0-.8-.8m-.8 6h-6.4V5.8h6.4ZM16 20h2v1.6h-2zm4 0h2v1.6h-2zm13-3.8h-8a.8.8 0 0 0-.8.8v6a.8.8 0 0 0 .8.8h8a.8.8 0 0 0 .8-.8v-6a.8.8 0 0 0-.8-.8m-.8 6h-6.4v-4.4h6.4Z"},null,-1),nt=ce("path",{fill:"none",d:"M0 0h36v36H0z"},null,-1),rt=[lt,nt];function st(m,S){return C(),me("svg",ot,[...rt])}const ut={name:"clarity-thin-client-solid",render:st},it=Z({name:"RetryTaskOperateDrawer",__name:"retry-task-operate-drawer",props:j({operateType:{},rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:j(["submitted"],["update:visible"]),setup(m,{emit:S}){const f=m,p=S,N=Y(m,"visible"),{formRef:R,validate:I,restoreValidation:w}=be(),{defaultRequiredRule:s}=he(),z=we(()=>({add:a("page.retryTask.addRetryTask"),edit:a("page.retryTask.editRetryTask")})[f.operateType]),i=fe(_()),c=q([]),u=q([]);function _(){return{groupName:"",sceneName:"",idempotentId:"",bizNo:"",executorName:"",argsStr:"",retryStatus:0}}const g={groupName:s,sceneName:s,idempotentId:s,bizNo:s,executorName:s,argsStr:s,retryStatus:s};function T(){if(f.operateType==="add"){Object.assign(i,_());return}f.operateType==="edit"&&f.rowData&&Object.assign(i,f.rowData)}function d(){N.value=!1}async function x(){var k;if(await I(),f.operateType==="add"){const{groupName:o,sceneName:b,idempotentId:U,bizNo:B,executorName:G,argsStr:O,retryStatus:K}=i,{error:W}=await Ye({groupName:o,sceneName:b,idempotentId:U,bizNo:B,executorName:G,argsStr:O,retryStatus:K});if(W)return;(k=window.$message)==null||k.success(a("common.addSuccess"))}d(),p("submitted")}ge(N,()=>{N.value&&(T(),w())});async function V(){const k=await ie();c.value=k.data}async function $(k){if(k){const o=await ke({groupName:k});u.value=o.data.map(b=>b.sceneName)}else i.sceneName="",u.value=[]}async function P(){const k=i.groupName,o=i.sceneName,b=i.executorName,U=i.argsStr,{data:B,error:G}=await tt({groupName:k,sceneName:o,executorName:b,argsStr:U});G||(i.idempotentId=B)}return ae(()=>{V()}),(k,o)=>{const b=ne,U=ve,B=re,G=ut,O=M,K=De,W=Ie,r=Ne,n=se;return C(),A(ue,{modelValue:N.value,"onUpdate:modelValue":o[7]||(o[7]=y=>N.value=y),title:z.value,onHandleSubmit:x},{footer:l(()=>[t(n,{size:16},{default:l(()=>[t(O,{onClick:d},{default:l(()=>[h(v(e(a)("common.cancel")),1)]),_:1}),t(O,{type:"primary",onClick:x},{default:l(()=>[h(v(e(a)("common.save")),1)]),_:1})]),_:1})]),default:l(()=>[t(r,{ref_key:"formRef",ref:R,model:i,rules:g},{default:l(()=>[t(U,{label:e(a)("page.retryTask.groupName"),path:"groupName"},{default:l(()=>[t(b,{value:i.groupName,"onUpdate:value":o[0]||(o[0]=y=>i.groupName=y),placeholder:e(a)("page.retryTask.form.groupName"),options:e(X)(c.value),disabled:f.operateType==="edit",onUpdateValue:$},null,8,["value","placeholder","options","disabled"])]),_:1},8,["label"]),t(U,{label:e(a)("page.retryTask.sceneName"),path:"sceneName"},{default:l(()=>[t(b,{value:i.sceneName,"onUpdate:value":o[1]||(o[1]=y=>i.sceneName=y),placeholder:e(a)("page.retryTask.form.sceneName"),options:e(X)(u.value),disabled:f.operateType==="edit"},null,8,["value","placeholder","options","disabled"])]),_:1},8,["label"]),t(U,{label:e(a)("page.retryTask.idempotentId"),path:"idempotentId"},{default:l(()=>[t(W,null,{default:l(()=>[t(B,{value:i.idempotentId,"onUpdate:value":o[2]||(o[2]=y=>i.idempotentId=y),placeholder:e(a)("page.retryTask.form.idempotentId"),disabled:f.operateType==="edit"},null,8,["value","placeholder","disabled"]),t(K,{trigger:"hover"},{trigger:l(()=>[t(O,{type:"default",ghost:"",disabled:f.operateType==="edit",onClick:P},{default:l(()=>[t(G,{class:"text-icon"})]),_:1},8,["disabled"])]),default:l(()=>[h(" "+v(e(a)("page.retryTask.generateIdempotentId")),1)]),_:1})]),_:1})]),_:1},8,["label"]),t(U,{label:e(a)("page.retryTask.bizNo"),path:"bizNo"},{default:l(()=>[t(B,{value:i.bizNo,"onUpdate:value":o[3]||(o[3]=y=>i.bizNo=y),placeholder:e(a)("page.retryTask.form.bizNo"),disabled:f.operateType==="edit"},null,8,["value","placeholder","disabled"])]),_:1},8,["label"]),t(U,{label:e(a)("page.retryTask.executorName"),path:"executorName"},{default:l(()=>[t(B,{value:i.executorName,"onUpdate:value":o[4]||(o[4]=y=>i.executorName=y),placeholder:e(a)("page.retryTask.form.executorName"),disabled:f.operateType==="edit"},null,8,["value","placeholder","disabled"])]),_:1},8,["label"]),t(U,{label:e(a)("page.retryTask.argsStr"),path:"argsStr"},{default:l(()=>[t(Oe,{modelValue:i.argsStr,"onUpdate:modelValue":o[5]||(o[5]=y=>i.argsStr=y),lang:"json",placeholder:e(a)("page.jobTask.form.argsStr")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),t(U,{label:e(a)("page.retryTask.retryStatus"),path:"retryStatus"},{default:l(()=>[t(b,{value:i.retryStatus,"onUpdate:value":o[6]||(o[6]=y=>i.retryStatus=y),placeholder:e(a)("page.retryTask.form.retryStatus"),options:e(oe)(e(le))},null,8,["value","placeholder","options"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),dt=Z({name:"RetryTaskBatchAddDrawer",__name:"retry-task-batch-add-drawer",props:{visible:{type:Boolean,default:!1},visibleModifiers:{}},emits:j(["submitted"],["update:visible"]),setup(m,{emit:S}){const f=S,p=Y(m,"visible"),{formRef:N,validate:R,restoreValidation:I}=be(),{defaultRequiredRule:w}=he(),s=fe(i()),z=q([]);function i(){return{groupName:"",retryStatus:0,logStr:""}}const c={groupName:w,retryStatus:w,logStr:w};function u(){p.value=!1}async function _(){var $;await R();const{groupName:T,retryStatus:d,logStr:x}=s,{error:V}=await Je({groupName:T,retryStatus:d,logStr:x});V||(($=window.$message)==null||$.success(a("common.addSuccess")),u(),f("submitted"))}async function g(){const T=await ie();z.value=T.data}return ge(p,()=>{p.value&&I()}),ae(()=>{g()}),(T,d)=>{const x=ne,V=ve,$=re,P=Ne,k=M,o=se;return C(),A(ue,{modelValue:p.value,"onUpdate:modelValue":d[3]||(d[3]=b=>p.value=b),title:e(a)("page.retryTask.batchAddRetryTask"),onHandleSubmit:_},{footer:l(()=>[t(o,{size:16},{default:l(()=>[t(k,{onClick:u},{default:l(()=>[h(v(e(a)("common.cancel")),1)]),_:1}),t(k,{type:"primary",onClick:_},{default:l(()=>[h(v(e(a)("common.save")),1)]),_:1})]),_:1})]),default:l(()=>[t(P,{ref_key:"formRef",ref:N,model:s,rules:c},{default:l(()=>[t(V,{label:e(a)("page.retryTask.groupName"),path:"groupName"},{default:l(()=>[t(x,{value:s.groupName,"onUpdate:value":d[0]||(d[0]=b=>s.groupName=b),placeholder:e(a)("page.retryTask.form.groupName"),options:e(X)(z.value)},null,8,["value","placeholder","options"])]),_:1},8,["label"]),t(V,{label:e(a)("page.retryTask.retryStatus"),path:"retryStatus"},{default:l(()=>[t(x,{value:s.retryStatus,"onUpdate:value":d[1]||(d[1]=b=>s.retryStatus=b),placeholder:e(a)("page.retryTask.form.retryStatus"),options:e(oe)(e(le))},null,8,["value","placeholder","options"])]),_:1},8,["label"]),t(V,{label:e(a)("page.retryTask.form.logStr"),path:"logStr"},{default:l(()=>[t($,{value:s.logStr,"onUpdate:value":d[2]||(d[2]=b=>s.logStr=b),type:"textarea",placeholder:e(a)("page.retryTask.form.logStr")},null,8,["value","placeholder"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),pt=Z({name:"RetryTaskSearch",__name:"retry-task-search",props:{model:{required:!0},modelModifiers:{}},emits:j(["reset","search"],["update:model"]),setup(m,{emit:S}){const f=S,p=Y(m,"model"),N=q([]),R=q([]);function I(){f("reset")}function w(){f("search")}async function s(){const i=await ie();N.value=i.data}async function z(i){if(i){const c=await ke({groupName:i});R.value=c.data.map(u=>u.sceneName)}else p.value.sceneName="",R.value=[]}return ae(()=>{s()}),(i,c)=>{const u=ne,_=Le,g=re,T=We;return C(),A(T,{model:p.value,onSearch:w,onReset:I},{default:l(()=>[t(_,{span:"24 s:12 m:6",label:e(a)("page.retryTask.groupName"),path:"groupName",class:"pr-24px"},{default:l(()=>[t(u,{value:p.value.groupName,"onUpdate:value":[c[0]||(c[0]=d=>p.value.groupName=d),z],placeholder:e(a)("page.retryTask.form.groupName"),options:e(X)(N.value),clearable:"",filterable:""},null,8,["value","placeholder","options"])]),_:1},8,["label"]),t(_,{span:"24 s:12 m:6",label:e(a)("page.retryTask.sceneName"),path:"sceneName",class:"pr-24px"},{default:l(()=>[t(u,{value:p.value.sceneName,"onUpdate:value":c[1]||(c[1]=d=>p.value.sceneName=d),placeholder:e(a)("page.retryTask.form.sceneName"),options:e(X)(R.value),clearable:""},null,8,["value","placeholder","options"])]),_:1},8,["label"]),t(_,{span:"24 s:12 m:6",label:e(a)("page.retryTask.uniqueId"),path:"uniqueId",class:"pr-24px"},{default:l(()=>[t(g,{value:p.value.uniqueId,"onUpdate:value":c[2]||(c[2]=d=>p.value.uniqueId=d),placeholder:e(a)("page.retryTask.form.uniqueId")},null,8,["value","placeholder"])]),_:1},8,["label"]),t(_,{span:"24 s:12 m:6",label:e(a)("page.retryTask.idempotentId"),path:"idempotentId",class:"pr-24px"},{default:l(()=>[t(g,{value:p.value.idempotentId,"onUpdate:value":c[3]||(c[3]=d=>p.value.idempotentId=d),placeholder:e(a)("page.retryTask.form.idempotentId")},null,8,["value","placeholder"])]),_:1},8,["label"]),t(_,{span:"24 s:12 m:6",label:e(a)("page.retryTask.bizNo"),path:"bizNo",class:"pr-24px"},{default:l(()=>[t(g,{value:p.value.bizNo,"onUpdate:value":c[4]||(c[4]=d=>p.value.bizNo=d),placeholder:e(a)("page.retryTask.form.bizNo")},null,8,["value","placeholder"])]),_:1},8,["label"]),t(_,{span:"24 s:12 m:6",label:e(a)("page.retryTask.retryStatus"),path:"retryStatus",class:"pr-24px"},{default:l(()=>[t(u,{value:p.value.retryStatus,"onUpdate:value":c[5]||(c[5]=d=>p.value.retryStatus=d),placeholder:e(a)("page.retryTask.form.retryStatus"),options:e(oe)(e(le))},null,8,["value","placeholder","options"])]),_:1},8,["label"])]),_:1},8,["model"])}}}),mt=Z({name:"SceneDetailDrawer",__name:"retry-task-detail-drawer",props:j({rowData:{}},{visible:{type:Boolean,default:!1},visibleModifiers:{}}),emits:["update:visible"],setup(m){const S=m,f=Y(m,"visible"),p=q([]),N=q(),R=new AbortController,I=q(!1);let w="0",s=0;async function z(){const{data:u,error:_}=await je({groupName:S.rowData.groupName,uniqueId:S.rowData.uniqueId,startId:w,fromIndex:s,size:50});_||(I.value=u.finished,w=u.nextStartId,s=u.fromIndex,u.message&&(p.value.push(...u.message),p.value.sort((g,T)=>Number.parseInt(g.time_stamp,10)-Number.parseInt(T.time_stamp,10))),I.value||(clearTimeout(N.value),N.value=setTimeout(z,1e3)))}const i=async u=>{u===1&&p.value.length===0&&await z()},c=()=>{I.value=!0,R.abort(),clearTimeout(N.value),N.value=void 0};return ze(()=>{c()}),(u,_)=>{const g=He,T=te,d=Ee,x=xe,V=Fe,$=Re,P=Ue,k=ue;return C(),A(k,{modelValue:f.value,"onUpdate:modelValue":_[1]||(_[1]=o=>f.value=o),title:e(a)("page.retryTask.detail")},{default:l(()=>[t(P,{type:"segment",animated:"","onUpdate:value":i},{default:l(()=>[t(x,{name:0,tab:e(a)("page.log.info")},{default:l(()=>[t(d,{"label-placement":"top",bordered:"",column:2},{default:l(()=>[t(g,{label:e(a)("page.retryTask.uniqueId"),span:2},{default:l(()=>{var o;return[h(v((o=u.rowData)==null?void 0:o.uniqueId),1)]}),_:1},8,["label"]),t(g,{label:e(a)("page.retryTask.groupName"),span:2},{default:l(()=>{var o;return[h(v((o=u.rowData)==null?void 0:o.groupName),1)]}),_:1},8,["label"]),t(g,{label:e(a)("page.retryTask.sceneName"),span:2},{default:l(()=>{var o;return[h(v((o=u.rowData)==null?void 0:o.sceneName),1)]}),_:1},8,["label"]),t(g,{label:e(a)("page.retryTask.nextTriggerAt"),span:1},{default:l(()=>{var o;return[h(v((o=u.rowData)==null?void 0:o.nextTriggerAt),1)]}),_:1},8,["label"]),t(g,{label:e(a)("page.retryTask.retryCount"),span:1},{default:l(()=>{var o;return[h(v((o=u.rowData)==null?void 0:o.retryCount),1)]}),_:1},8,["label"]),t(g,{label:e(a)("page.retryTask.retryStatus"),span:1},{default:l(()=>{var o;return[t(T,{type:e(ee)((o=u.rowData)==null?void 0:o.retryStatus)},{default:l(()=>{var b;return[h(v(e(a)(e(ye)[(b=u.rowData)==null?void 0:b.retryStatus])),1)]}),_:1},8,["type"])]}),_:1},8,["label"]),t(g,{label:e(a)("page.retryTask.taskType"),span:1},{default:l(()=>{var o;return[t(T,{type:e(ee)((o=u.rowData)==null?void 0:o.taskType)},{default:l(()=>{var b;return[h(v(e(a)(e(_e)[(b=u.rowData)==null?void 0:b.taskType])),1)]}),_:1},8,["type"])]}),_:1},8,["label"]),t(g,{label:e(a)("page.retryTask.bizNo"),span:2},{default:l(()=>{var o;return[h(v((o=u.rowData)==null?void 0:o.bizNo),1)]}),_:1},8,["label"]),t(g,{label:e(a)("page.retryTask.idempotentId"),span:2},{default:l(()=>{var o;return[h(v((o=u.rowData)==null?void 0:o.idempotentId),1)]}),_:1},8,["label"]),t(g,{label:e(a)("page.retryTask.executorName"),span:2},{default:l(()=>{var o;return[h(v((o=u.rowData)==null?void 0:o.executorName),1)]}),_:1},8,["label"]),t(g,{label:e(a)("page.retryTask.argsStr"),span:2},{default:l(()=>{var o;return[h(v((o=u.rowData)==null?void 0:o.argsStr),1)]}),_:1},8,["label"]),t(g,{label:e(a)("common.createDt"),span:1},{default:l(()=>{var o;return[h(v((o=u.rowData)==null?void 0:o.createDt),1)]}),_:1},8,["label"]),t(g,{label:e(a)("common.updateDt"),span:1},{default:l(()=>{var o;return[h(v((o=u.rowData)==null?void 0:o.updateDt),1)]}),_:1},8,["label"])]),_:1})]),_:1},8,["tab"]),t(x,{name:1,tab:e(a)("page.log.title"),"display-directive":"if"},{default:l(()=>[p.value.length>0?(C(),A(V,{key:0,modelValue:p.value,"onUpdate:modelValue":_[0]||(_[0]=o=>p.value=o),drawer:!1},null,8,["modelValue"])):(C(),A($,{key:1,class:"h-full"}))]),_:1},8,["tab"])]),_:1})]),_:1},8,["modelValue","title"])}}}),ct={class:"min-h-500px flex-col-stretch gap-16px overflow-hidden lt-sm:overflow-auto"};function F(m){return typeof m=="function"||Object.prototype.toString.call(m)==="[object Object]"&&!Ve(m)}const xt=Z({name:"retry_task",__name:"index",setup(m){const S=q(),{bool:f,setTrue:p}=de(!1),N=$e(),{columns:R,columnChecks:I,data:w,getData:s,loading:z,mobilePagination:i,searchParams:c,resetSearchParams:u}=Pe({apiFn:Ke,apiParams:{page:1,size:10,uniqueId:null,groupName:null,sceneName:null,idempotentId:null,bizNo:null,retryStatus:null},columns:()=>[{type:"selection",align:"center",width:48},{key:"uniqueId",title:a("page.retryTask.uniqueId"),align:"left",fixed:"left",minWidth:120,render:r=>{async function n(){await o(r),p()}return t(M,{text:!0,tag:"a",type:"primary",onClick:n,class:"ws-normal"},{default:()=>[r.uniqueId]})}},{key:"groupName",title:a("page.retryTask.groupName"),align:"left",resizable:!0,minWidth:120,maxWidth:250},{key:"sceneName",title:a("page.retryTask.sceneName"),align:"left",minWidth:120},{key:"nextTriggerAt",title:a("page.retryTask.nextTriggerAt"),align:"left",resizable:!0,minWidth:120,maxWidth:150},{key:"retryCount",title:a("page.retryTask.retryCount"),align:"center",width:80},{key:"retryStatus",title:a("page.retryTask.retryStatus"),align:"left",width:120,render:r=>{if(r.retryStatus===null)return null;const n=a(ye[r.retryStatus]);return t(te,{type:ee(r.retryStatus)},F(n)?n:{default:()=>[n]})}},{key:"taskType",title:a("page.retryTask.taskType"),align:"left",width:100,render:r=>{if(r.taskType===null)return null;const n={1:"warning",2:"error"},y=a(_e[r.taskType]);return t(te,{type:n[r.taskType]},F(y)?y:{default:()=>[y]})}},{key:"idempotentId",title:a("page.retryTask.idempotentId"),align:"left",resizable:!0,minWidth:150,maxWidth:300},{key:"bizNo",title:a("page.retryTask.bizNo"),align:"left",resizable:!0,minWidth:150,maxWidth:300},{key:"operate",title:a("common.operate"),align:"left",width:260,fixed:"right",render:r=>t("div",{class:"flex-center gap-8px"},[r.retryStatus!==1&&r.retryStatus!==2?t(E,{onPositiveClick:()=>B(r.groupName,r.uniqueId)},{default:()=>a("common.confirmExecute"),trigger:()=>{let n;return t(M,{type:"info",ghost:!0,size:"small"},F(n=a("common.execute"))?n:{default:()=>[n]})}}):"",r.retryStatus!==1&&r.retryStatus!==2?t(E,{onPositiveClick:()=>K(Number(r.id),r.groupName)},{default:()=>a("common.confirmFinish"),trigger:()=>{let n;return t(M,{type:"warning",ghost:!0,size:"small"},F(n=a("common.finish"))?n:{default:()=>[n]})}}):"",r.retryStatus===0?t(E,{onPositiveClick:()=>O(Number(r.id),r.groupName)},{default:()=>a("common.confirmPause"),trigger:()=>{let n;return t(M,{type:"success",ghost:!0,size:"small"},F(n=a("common.pause"))?n:{default:()=>[n]})}}):"",r.retryStatus===3?t(E,{onPositiveClick:()=>G(Number(r.id),r.groupName)},{default:()=>a("common.confirmResume"),trigger:()=>{let n;return t(M,{type:"info",ghost:!0,size:"small"},F(n=a("common.resume"))?n:{default:()=>[n]})}}):"",t(E,{onPositiveClick:()=>k(r.groupName,r.id)},{default:()=>a("common.confirmDelete"),trigger:()=>{let n;return t(M,{type:"error",ghost:!0,size:"small"},F(n=a("common.delete"))?n:{default:()=>[n]})}})])}]}),{drawerVisible:_,operateType:g,handleAdd:T,checkedRowKeys:d,onBatchDeleted:x,onDeleted:V}=Ge(w,s),{bool:$,setTrue:P}=de();async function k(r,n){const{error:y}=await pe({groupName:r,ids:[n]});y||V()}async function o(r){const n=await Xe(r.id,r.groupName);S.value=n.data||null}async function b(){const r=d.value;if(r.length===0)return;const n=w.value[0].groupName,{error:y}=await pe({groupName:n,ids:r});y||x()}function U(){P()}function B(r,n){et({groupName:r,uniqueIds:[n]})}function G(r,n){W(r,n,0)}function O(r,n){W(r,n,3)}function K(r,n){W(r,n,1)}async function W(r,n,y){var D;const{error:J}=await Qe({id:r,groupName:n,retryStatus:y});J||((D=window.$message)==null||D.success(a("common.updateSuccess")),s())}return(r,n)=>{const y=Ze,J=Ce;return C(),me("div",ct,[t(pt,{model:e(c),"onUpdate:model":n[0]||(n[0]=D=>H(c)?c.value=D:null),onReset:e(u),onSearch:e(s)},null,8,["model","onReset","onSearch"]),t(J,{title:e(a)("page.retryTask.title"),bordered:!1,size:"small",class:"sm:flex-1-hidden card-wrapper","header-class":"view-card-header"},{"header-extra":l(()=>[t(at,{columns:e(I),"onUpdate:columns":n[1]||(n[1]=D=>H(I)?I.value=D:null),"disabled-delete":e(d).length===0,loading:e(z),onAdd:e(T),onBatchAdd:U,onDelete:b,onRefresh:e(s)},null,8,["columns","disabled-delete","loading","onAdd","onRefresh"])]),default:l(()=>[t(y,{"checked-row-keys":e(d),"onUpdate:checkedRowKeys":n[2]||(n[2]=D=>H(d)?d.value=D:null),columns:e(R),data:e(w),"flex-height":!e(N).isMobile,"scroll-x":2e3,loading:e(z),remote:"","row-key":D=>D.id,pagination:e(i),class:"sm:h-full"},null,8,["checked-row-keys","columns","data","flex-height","loading","row-key","pagination"]),t(it,{visible:e(_),"onUpdate:visible":n[3]||(n[3]=D=>H(_)?_.value=D:null),"operate-type":e(g),onSubmitted:e(s)},null,8,["visible","operate-type","onSubmitted"]),t(dt,{visible:e($),"onUpdate:visible":n[4]||(n[4]=D=>H($)?$.value=D:null),onSubmitted:e(s)},null,8,["visible","onSubmitted"]),t(mt,{visible:e(f),"onUpdate:visible":n[5]||(n[5]=D=>H(f)?f.value=D:null),"row-data":S.value},null,8,["visible","row-data"])]),_:1},8,["title"])])}}});export{xt as default};
